{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* global Office */\n\n// üî• BACKEND CONFIGURATION\n// CHANGE THIS URL AFTER DEPLOYING TO RENDER\n// const BACKEND_URL = \"https://YOUR-APP-NAME.onrender.com\"; \n// Example: \"https://phishing-detector-abc123.onrender.com\"\n// Get this URL after Render deployment (Step 5 in deployment guide)\nwindow.autoReportedMessageIds = new Set();\n\nconst BACKEND_URL = \"https://phishbuster-backend-z1a7.onrender.com\";\nconst POWER_AUTOMATE_URL = \"https://make.powerautomate.com/\";\n\n\nconst POWER_AUTOMATE_REPORT_URL = \"https://defaultbe72d8b946d24e37b7f93ee54da231.6f.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/32b98a3c81104e0790786be7c33e3cee/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=IIxn0XC1QUI6g7_Zre5S0pqyRyHFv-MfAb0XFLIH3sQ\";// User's flow URL will go here\n\nOffice.onReady(() => {\n  document.getElementById(\"sideload-msg\").style.display = \"none\";\n  document.getElementById(\"app-body\").style.display = \"block\";\n\n  // INITIAL UI STATE\n  document.getElementById(\"resultsSection\").style.display = \"none\";\n  document.getElementById(\"scanSummary\").style.display = \"none\";\n  document.getElementById(\"appDescription\").style.display = \"block\";\n  document.getElementById(\"reportButton\").style.display = \"none\";\n\n  // üî• NEW: Check Auto-Scan Status on Load\n  checkAutoScanStatus();\n\n  // Button Event Listeners\n  document.getElementById(\"run\").onclick = analyzeCurrentEmail;\n  // document.getElementById(\"scanUnread\").onclick = scanUnreadEmails;\n  document.getElementById(\"manageAutoScan\").onclick = openAutoScanSettings;\n});\n\n// ==========================================================\n// üî• NEW: CHECK AUTO-SCAN STATUS\n// ==========================================================\n\nfunction checkAutoScanStatus() {\n  // For \"Better UX\" approach, we assume Power Automate flow is enabled\n  // In production, you could call your backend to check if flow exists\n  \n  const statusBadge = document.getElementById(\"autoScanBadge\");\n  const statusText = document.getElementById(\"autoScanStatus\");\n  \n  // Simulate checking status (in real implementation, call backend)\n  setTimeout(() => {\n    // Assume flow is enabled (user manages this in Power Automate)\n    statusBadge.classList.add(\"status-active\");\n    statusText.innerText = \"Active\";\n  }, 500);\n}\n\n// ==========================================================\n// üî• NEW: OPEN POWER AUTOMATE SETTINGS\n// ==========================================================\n\nfunction openAutoScanSettings() {\n  try {\n    window.open(POWER_AUTOMATE_URL, \"_blank\");\n  } catch (e) {\n    console.error(\"Failed to open Power Automate:\", e);\n  }\n}\n\n\n// ==========================================================\n// üî• NEW: SCAN ALL UNREAD EMAILS\n// ==========================================================\n\nasync function scanUnreadEmails() {\n  try {\n    document.getElementById(\"resultsSection\").style.display = \"none\";\n    document.getElementById(\"scanSummary\").style.display = \"block\";\n    document.getElementById(\"appDescription\").style.display = \"none\";\n    \n    // Reset counters\n    document.getElementById(\"safeCount\").innerText = \"...\";\n    document.getElementById(\"suspiciousCount\").innerText = \"...\";\n    document.getElementById(\"phishingCount\").innerText = \"...\";\n    document.getElementById(\"phishingList\").innerHTML = \"<p>üîç Scanning unread emails...</p>\";\n\n    // Get mailbox\n    const mailbox = Office.context.mailbox;\n    \n    // Get unread emails from inbox\n    mailbox.getCallbackTokenAsync({ isRest: true }, function (result) {\n      if (result.status === \"succeeded\") {\n        const token = result.value;\n        \n        // Get REST API URL\n        const restUrl = mailbox.restUrl;\n        const filterQuery = \"$filter=IsRead eq false&$top=20&$select=Subject,From,BodyPreview\";\n        const url = `${restUrl}/v2.0/me/messages?${filterQuery}`;\n        \n        // Fetch unread emails\n        fetch(url, {\n          method: \"GET\",\n          headers: {\n            \"Authorization\": \"Bearer \" + token,\n            \"Content-Type\": \"application/json\"\n          }\n        })\n        .then(response => response.json())\n        .then(data => {\n          if (data.value && data.value.length > 0) {\n            scanEmailsBatch(data.value);\n          } else {\n            document.getElementById(\"phishingList\").innerHTML = \n              \"<p>‚úÖ No unread emails found.</p>\";\n          }\n        })\n        .catch(err => {\n          console.error(\"Error fetching emails:\", err);\n          document.getElementById(\"phishingList\").innerHTML = \n            \"<p>‚ùå Could not fetch unread emails. Please try again.</p>\";\n        });\n      }\n    });\n    \n  } catch (err) {\n    console.error(\"Error in scanUnreadEmails:\", err);\n    console.error(\"Failed to report to admin via Power Automate.\");\n\n  }\n}\n\n// ==========================================================\n// SCAN MULTIPLE EMAILS\n// ==========================================================\n\nasync function scanEmailsBatch(emails) {\n  let safeCount = 0;\n  let suspiciousCount = 0;\n  let phishingCount = 0;\n  let phishingEmails = [];\n\n  document.getElementById(\"phishingList\").innerHTML = \"<p>‚è≥ Analyzing emails...</p>\";\n\n  // Scan each email\n  for (const email of emails) {\n    try {\n      const response = await fetch(`${BACKEND_URL}/analyze`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          sender: email.From.EmailAddress.Address,\n          subject: email.Subject,\n          body: email.BodyPreview\n        })\n      });\n\n      const data = await response.json();\n      \n      if (data.result === true) {\n        phishingCount++;\n        phishingEmails.push({\n          subject: email.Subject,\n          sender: email.From.EmailAddress.Address\n        });\n      } else if (data.result === \"Suspicious\") {\n        suspiciousCount++;\n      } else {\n        safeCount++;\n      }\n      \n    } catch (err) {\n      console.error(\"Error analyzing email:\", err);\n    }\n  }\n\n  // Update UI\n  document.getElementById(\"safeCount\").innerText = safeCount;\n  document.getElementById(\"suspiciousCount\").innerText = suspiciousCount;\n  document.getElementById(\"phishingCount\").innerText = phishingCount;\n\n  // Show phishing emails list\n  if (phishingEmails.length > 0) {\n    let listHtml = \"<div class='phishing-list'><h4>üö® Phishing Emails Detected:</h4>\";\n    phishingEmails.forEach(email => {\n      listHtml += `\n        <div class='phishing-item'>\n          <strong>Subject:</strong> ${email.subject}<br>\n          <strong>From:</strong> ${email.sender}\n        </div>\n      `;\n    });\n    listHtml += \"</div>\";\n    document.getElementById(\"phishingList\").innerHTML = listHtml;\n  } else {\n    document.getElementById(\"phishingList\").innerHTML = \n      \"<p style='color: #28a745; margin-top: 15px;'>‚úÖ No phishing emails detected!</p>\";\n  }\n}\n\n// ==========================================================\n// ANALYZE CURRENT EMAIL (ORIGINAL FUNCTION - KEPT)\n// ==========================================================\n\nfunction analyzeCurrentEmail() {\n  try {\n    const item = Office.context.mailbox.item;\n\n    // Hide scan summary, show results section\n    document.getElementById(\"scanSummary\").style.display = \"none\";\n    document.getElementById(\"resultsSection\").style.display = \"block\";\n    document.getElementById(\"appDescription\").style.display = \"none\";\n\n    // RESET UI\n    document.getElementById(\"statusText\").innerText = \"Analyzing...\";\n    document.getElementById(\"confidenceText\").innerText = \"\";\n    document.getElementById(\"analysisMessage\").innerText = \"\";\n    document.getElementById(\"links\").innerText = \"\";\n    document.getElementById(\"suspiciousWords\").innerText = \"\";\n    document.getElementById(\"riskLevel\").innerText = \"\";\n\n    const statusBox = document.getElementById(\"statusBox\");\n    statusBox.style.backgroundColor = \"#f3f2f1\";\n    statusBox.style.border = \"1px solid #ccc\";\n\n    let subject = item.subject || \"\";\n\n    item.body.getAsync(Office.CoercionType.Text, async function (result) {\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        document.getElementById(\"statusText\").innerText =\n          \"Failed to read email body.\";\n        return;\n      }\n\n      const body = result.value;\n      const sender =\n        item.from?.emailAddress?.address || \"\";\n\n      try {\n        const response = await fetch(`${BACKEND_URL}/analyze-outlook`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            subject: subject,\n            body: body,\n            sender: sender\n          })\n        });\n\n        if (!response.ok) {\n          document.getElementById(\"statusText\").innerText =\n            \"Backend error: \" + response.status;\n          return;\n        }\n\n        const data = await response.json();\n        // ================= INTERNAL / EXTERNAL BADGE =================\n//         const originBadge = document.getElementById(\"originBadge\");\n//         const originLabel = document.getElementById(\"originLabel\");\n\n//         if (typeof data.isInternal !== \"undefined\") {\n//           originBadge.style.display = \"block\";\n\n//           if (data.isInternal) {\n//             originLabel.innerText = \"INTERNAL\";\n//             originLabel.className = \"origin-badge origin-internal\";\n//           } else {\n//             originLabel.innerText = \"EXTERNAL\";\n//             originLabel.className = \"origin-badge origin-external\";\n//           }\n//         } else {\n//           originBadge.style.display = \"none\";\n// }\n\n                // Set base analysis message first\n        document.getElementById(\"analysisMessage\").innerText =\n          data.analysisMessage || data.aiExplanation || \"No detailed analysis available.\";\n\n        // STORE LAST ANALYSIS FOR REPORTING\n        // STORE LAST ANALYSIS FOR REPORTING\n        window.lastAnalysis = {\n          category: data.category,\n          sender: sender,\n          subject: subject,\n          reason: data.reason,\n          messageId: item.itemId || \"\",\n          confidence: data.confidence || null\n        };\n        \n        // Store current email info for manual reporting\n        window.currentMessageId = item.itemId || \"\";\n        window.currentSender = sender || \"\";\n\n        window.currentUserEmail = Office.context.mailbox.userProfile.emailAddress || \"\";\n        window.currentSubject = subject || \"\";\n\n        // ================= FIXED LOGIC =================\n\n        // ================= CATEGORY-BASED LOGIC =================\n\n        const category = data.category; // SAFE | SUSPICIOUS | PHISHING\n        const reportBtn = document.getElementById(\"reportButton\");\n\n        // Show button only for PHISHING or SUSPICIOUS\n        if (category === \"PHISHING\" || category === \"SUSPICIOUS\") {\n          reportBtn.style.display = \"block\";\n        } else {\n          reportBtn.style.display = \"none\";\n        }\n\n        const confidence = data.confidence ?? null;\n        \n\n        // ================= UI UPDATE =================\n\n        const statusText = document.getElementById(\"statusText\");\n        const confidenceText = document.getElementById(\"confidenceText\");\n\n        if (category === \"PHISHING\") {\n          statusBox.style.backgroundColor = \"#fdecea\";\n          statusBox.style.border = \"2px solid #d93025\";\n          statusText.innerText = \"üö® PHISHING DETECTED\";\n          statusText.style.color = \"#d93025\";\n        \n          confidenceText.innerText = \"Confidence: \" + confidence + \"%\";\n          const msgId = item.itemId || \"\";\n          if (!window.autoReportedMessageIds.has(msgId)) {\n            window.autoReportedMessageIds.add(msgId);\n            \n            document.getElementById(\"analysisMessage\").innerText += \n            \"\\n\\nüö® This phishing email was automatically reported to Admin.\";\n          }\n        \n        } else if (category === \"SUSPICIOUS\") {\n          statusBox.style.backgroundColor = \"#fff3cd\";\n          statusBox.style.border = \"2px solid #ffc107\";\n          statusText.innerText = \"‚ö†Ô∏è SUSPICIOUS EMAIL\";\n          statusText.style.color = \"#856404\";\n        \n          confidenceText.innerText = \"\";\n        \n        } else {\n          statusBox.style.backgroundColor = \"#e6f4ea\";\n          statusBox.style.border = \"2px solid #188038\";\n          statusText.innerText = \"‚úÖ SAFE EMAIL\";\n          statusText.style.color = \"#188038\";\n        \n          confidenceText.innerText = \"\";\n        }\n        \n\n        // REAL DETAILS\n        const links = data.details?.links || [];\n        const words = data.details?.suspiciousWords || [];\n\n        document.getElementById(\"links\").innerText =\n          links.length > 0 ? links.join(\", \") : \"None\";\n\n        document.getElementById(\"suspiciousWords\").innerText =\n          words.length > 0 ? words.join(\", \") : \"None\";\n\n        document.getElementById(\"riskLevel\").innerText = category;\n\n\n      \n\n      } catch (apiErr) {\n        console.error(\"Frontend error after API call:\", apiErr);\n        document.getElementById(\"statusText\").innerText =\n          \"Error while processing response. Check console.\";\n      }\n    });\n\n  } catch (err) {\n    console.error(err);\n    document.getElementById(\"statusText\").innerText =\n      \"Unexpected error.\";\n  }\n}\ndocument.getElementById(\"reportButton\").onclick = async function () {\n  console.log(\"üöÄ Report button clicked, sending to Power Automate...\");\n  if (!window.lastAnalysis) {\n    showReportSuccess(\"No analysis available to report.\");\n    return;\n  }\n\n  // üö® Only allow reporting for PHISHING / SUSPICIOUS\n  if (![\"PHISHING\", \"SUSPICIOUS\"].includes(window.lastAnalysis.category)) {\n    showReportSuccess(\"Only suspicious or phishing emails can be reported.\");\n    return;\n  }\n\n  const reportPayload = {\n    messageId: window.currentMessageId || \"\",\n    category: window.lastAnalysis.category,\n    confidence: window.lastAnalysis.confidence || null,\n    ruleHits: window.lastAnalysis.reason\n      ? window.lastAnalysis.reason.split(\";\")\n      : [],\n    sender: window.currentSender || \"\",\n    reportedBy: window.currentUserEmail || \"\"\n  };\n \n\n\n  try {\n    const response = await fetch(POWER_AUTOMATE_REPORT_URL, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        category: reportPayload.category,\n        confidence: reportPayload.confidence,\n        sender: reportPayload.sender,\n        subject: window.currentSubject || \"\",\n        messageId: reportPayload.messageId\n      })\n    });\n\n    if (response.ok) {\n      showReportSuccess(\"Reported to IT Admin for review.\");\n    } else {\n      alertconsole.error(\"Failed to report to admin via Power Automate.\");\n    }\n    \n\n  } catch (err) {\n    console.error(err);\n    showReportSuccess(\"Failed to report email.\");\n  }\n};\n\nfunction showReportSuccess(message) {\n  const msgBox = document.getElementById(\"analysisMessage\");\n  msgBox.innerText = \"‚úÖ \" + (message || \"Reported successfully\");\n  msgBox.style.color = \"green\";\n}\n\n\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/icon-80.png\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"Content-Security-Policy\\\" content=\\\" default-src 'self' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://appsforoffice.microsoft.com https: http://localhost:3000; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' https: data:; connect-src 'self' https: http://localhost:3000 ws://localhost:3000 http://127.0.0.1:8000 http://localhost:8000 https://phishbuster-backend-z1a7.onrender.com https://*.environment.api.powerplatform.com; frame-src 'self' https:; \\\"> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Outlook Phishing Analyzer</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header\\\"> <div class=\\\"shield-logo\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Security Shield\\\"/> </div> <h2>Phishing Analyzer</h2> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\"> Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body. </h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div class=\\\"status-card\\\"> <div class=\\\"status-header\\\"> <h3>üõ°Ô∏è Auto-Scan Protection</h3> <div class=\\\"status-badge\\\" id=\\\"autoScanBadge\\\"> <span class=\\\"status-dot\\\"></span> <span id=\\\"autoScanStatus\\\">Checking...</span> </div> </div> <p class=\\\"status-description\\\"> Automatically scanning all incoming emails for phishing threats. </p> <button id=\\\"manageAutoScan\\\" class=\\\"btn-secondary\\\"> ‚öôÔ∏è Manage Auto-Scan Settings </button> </div> <div id=\\\"appDescription\\\"> <h4>Manual Email Check</h4> <p> Click the button below to analyze the currently open email for phishing threats. </p> <ul class=\\\"feature-list\\\"> <li>‚úì Scans suspicious URLs and domains</li> <li>‚úì Detects urgency-based social engineering</li> <li>‚úì Identifies sender authentication issues</li> <li>‚úì Provides actionable security insights</li> </ul> </div> <button id=\\\"run\\\" class=\\\"analyze-button\\\"> üîç Analyze Current Email </button> <div id=\\\"scanSummary\\\" style=\\\"display:none\\\" class=\\\"scan-summary\\\"> <h4>Scan Results</h4> <div class=\\\"summary-grid\\\"> <div class=\\\"summary-item safe\\\"> <div class=\\\"summary-count\\\" id=\\\"safeCount\\\">0</div> <div class=\\\"summary-label\\\">Safe</div> </div> <div class=\\\"summary-item suspicious\\\"> <div class=\\\"summary-count\\\" id=\\\"suspiciousCount\\\">0</div> <div class=\\\"summary-label\\\">Suspicious</div> </div> <div class=\\\"summary-item phishing\\\"> <div class=\\\"summary-count\\\" id=\\\"phishingCount\\\">0</div> <div class=\\\"summary-label\\\">Phishing</div> </div> </div> <div id=\\\"phishingList\\\"></div> </div> <div id=\\\"resultsSection\\\" style=\\\"display:none\\\"> <hr/> <div id=\\\"statusBox\\\"> <h3 id=\\\"statusText\\\"></h3> <p id=\\\"confidenceText\\\"></p> </div> <div id=\\\"analysisMessageBox\\\"> <b>Security Insight</b> <p id=\\\"analysisMessage\\\"></p> </div> <h4>Analysis Details</h4> <ul> <li>Links Found: <b><span id=\\\"links\\\"></span></b></li> <li>Suspicious Words: <b><span id=\\\"suspiciousWords\\\"></span></b></li> <li>Risk Level: <b><span id=\\\"riskLevel\\\"></span></b></li> </ul> <button id=\\\"reportButton\\\" class=\\\"analyze-button\\\" style=\\\"margin-top:12px\\\"> üö® Report to ADMIN </button> </div> </main> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","autoReportedMessageIds","Set","openAutoScanSettings","open","console","error","analyzeCurrentEmail","item","Office","context","mailbox","getElementById","style","display","innerText","statusBox","backgroundColor","border","subject","body","getAsync","CoercionType","Text","_ref","_callee","result","_item$from","sender","_data$confidence","_data$details","_data$details2","response","data","category","confidence","statusText","confidenceText","msgId","links","words","_t","_context","status","AsyncResultStatus","Succeeded","from","emailAddress","address","fetch","concat","method","headers","JSON","stringify","ok","json","analysisMessage","aiExplanation","lastAnalysis","reason","messageId","itemId","currentMessageId","currentSender","currentUserEmail","userProfile","currentSubject","color","has","add","details","suspiciousWords","join","_x2","err","showReportSuccess","message","msgBox","onReady","statusBadge","setTimeout","classList","onclick","_callee2","reportPayload","_t2","_context2","log","includes","ruleHits","split","reportedBy","alertconsole","URL"],"ignoreList":[],"sourceRoot":""}